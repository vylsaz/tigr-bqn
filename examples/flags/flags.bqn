âŸ¨_WindowWithFlag, Free, tfont, tk â‡ key, flagâŸ© â† â€¢Import "../../tigr.bqn"

And â† {âŸ¨ğ•¨âŸ©32â€¢bit._andâŸ¨ğ•©âŸ©}
MakeDemoWindow â† {"Flag tester" ğ•¨ _WindowWithFlag ğ•©}
DrawDemoWindow â† {ğ•Š win:
    lineColor â† 100â€¿100â€¿100
    lineColor win.Line âŸ¨0, 0, (win.W@)-1, (win.H@)-1âŸ©
    lineColor win.Line âŸ¨0, (win.H@)-1, (win.W@)-1, 0âŸ©
    200â€¿10â€¿10 win.Rect âŸ¨0, 0, win.W@, win.H@âŸ©
    20â€¿200â€¿0 win tfont._Print_({ğ•¨âˆ¾"x"âˆ¾ğ•©}Â´â€¢FmtÂ¨(win.Wâˆ¾win.H)@) 5â€¿5
}

DrawToggle â† {textâ€¿checkedâ€¿valueâ€¿keyâ€¿color ğ•Š bmpâ€¿xâ€¿yâ€¿stride:
    h â† tfont.TextHeight text
    w â† tfont.TextWidth text

    yOffset â† âŒŠstrideÃ·2
    xOffset â† âŒŠwÃ·Â¯2
    color bmp tfont._Print_ text âŸ¨x+xOffset, y+yOffsetâŸ©
    yOffset +â†© {checked? h; âŒŠhÃ·3}
    lineColor â† colorâˆ¾240
    lineColor bmp.Line âŸ¨x+xOffset, y+yOffset, x+xOffset+w, y+yOffsetâŸ©
}

flags â† 0
initialW â† 400
initialH â† 400
win â† flags MakeDemoWindow âŸ¨initialW, initialHâŸ©

white â† 255â€¿255â€¿255
yellow â† 255â€¿255â€¿0
black â† 0â€¿0â€¿0

toggles â† âŸ¨
    âŸ¨ "(A)UTO", 0, flag.auto, 'A', white âŸ©
    âŸ¨ "(R)ETINA", 0, flag.retina, 'R', white âŸ©
    âŸ¨ "(F)ULLSCREEN", 0, flag.fullscreen, 'F', white âŸ©
    âŸ¨ "(2)X", 0, flag.scale2x, '2', yellow âŸ©
    âŸ¨ "(3)X", 0, flag.scale3x, '3', yellow âŸ©
    âŸ¨ "(4)X", 0, flag.scale4x, '4', yellow âŸ©
    âŸ¨ "(N)OCURSOR", 0, flag.nocursor, 'N', white âŸ©
âŸ©

{ğ•Š:
    win.Clear black
    DrawDemoWindow win

    numToggles â† â‰ toggles
    stepY â† âŒŠ(win.H@)Ã·numToggles
    toggleY â† 0
    toggleX â† âŒŠ(win.W@)Ã·2

    {
        newFlags â† 0
        {ğ•Š i:
            textâ€¿checkedâ€¿valueâ€¿keyâ€¿color â† iâŠ‘toggles
            {win.KeyDown key? checked Â¬â†©; @}
            newFlags +â†© checkedÃ—value
            toggle â† textâ€¿checkedâ€¿valueâ€¿keyâ€¿color
            toggle DrawToggle winâ€¿toggleXâ€¿toggleYâ€¿stepY
            toggles toggleâŒ¾(iâŠ¸âŠ‘)â†© 
            toggleY +â†© stepY
        }Â¨â†•numToggles

        {flagsâ‰ newFlags?
            modeFlags â† flag.auto+flag.retina
            modeChange â† (flags And modeFlags)â‰¢newFlags And modeFlags
            flags â†© newFlags

            w â† {modeChange? initialW; win.W@}
            h â† {modeChange? initialH; win.H@}
            Free win
            win â†© flags MakeDemoWindow âŸ¨w, hâŸ©
        ;@}
    }

    win.Update@
}â€¢_while_((Â¬ win.Closed)âˆ§(Â¬ win.KeyDownâŸœtk.escape))@
Free win
